---
title: äºŒç»´ç åŸç†
date: 2019-08-05 21:30:59
summary_img: /images/canyon.jpg
tags: [QR]
---

# å‰è¨€

å‰é˜µå­åœ¨é¡¹ç›®é‡Œç”¨åˆ°äº†äºŒç»´ç çš„ç”Ÿæˆï¼Œå½“æ—¶ç›´æ¥æ‹¿äº†ç¬¬ä¸‰æ–¹åº“æ¥åšï¼Œè§‰å¾—å¾ˆç¥å¥‡ï¼Œæ°å¥½è¿™ä¸¤å¤©æœ‰ä¸€ç‚¹æ—¶é—´ï¼Œå°±å­¦ä¹ äº†ä¸€æ³¢åº•å±‚åŸç†ã€‚å­¦ä¹ çš„è¿‡ç¨‹ä¸­å‚è€ƒäº†å¥½å‡ ä¸ªåšå®¢ï¼Œä¸åŒçš„åšå®¢åœ¨ä¸åŒçš„ç»†èŠ‚ä¸Šå†™çš„æ¯”è¾ƒå¥½ï¼Œè¶ç€è¿˜æ²¡å¿˜å°±è¶çƒ­æ‰“é“è®°å½•åœ¨åšå®¢é‡Œã€‚

**äºŒç»´ç æœ¬è´¨ä¸Šæ˜¯å¯¹å­—ç¬¦ä¸²çš„ç¼–ç è§„åˆ™ï¼Œæœ€ç»ˆè½¬æ¢æˆäºŒè¿›åˆ¶ä¸²**ã€‚ä¸è¿‡åœ¨è¿™ä¸ªä¸²é‡ŒåŠ äº†å„ç§è¾…åŠ©ä¿¡æ¯ä»¥åŠçº é”™ä¿¡æ¯ï¼Œæœ€ç»ˆç»˜åˆ¶åˆ°é¡µé¢ä¸Šæ—¶å°±æˆäº†çœ¼ç›çœ‹åˆ°çš„æ ·å­ã€‚

# åŸºç¡€çŸ¥è¯†

äºŒç»´ç ä¸€å…±æœ‰`40`ä¸ªå°ºå¯¸(ä¹Ÿå¯ä»¥ç§°ä¸ºç‰ˆæœ¬ã€`Version`)ã€‚`Version 1`æ˜¯`21 x 21`çš„çŸ©é˜µï¼Œ`Version 2`æ˜¯ `25 x 25`çš„çŸ©é˜µã€‚æ¯å¢åŠ ä¸€ä¸ª`version`ï¼Œé•¿å®½å°±å¢åŠ  4ï¼Œå…¬å¼æ˜¯ï¼š

```js
(V - 1) * 4 + 21;
```

æœ€é«˜ç‰ˆæœ¬æ˜¯`40`ï¼Œæ‰€ä»¥æ˜¯`177 x 177`çš„æ­£æ–¹å½¢ã€‚ æ¯ä¸ª`1x1`éƒ½æ˜¯ä¸€ä¸ªå°æ–¹å—ï¼Œé»‘è‰²è¡¨ç¤º 1ï¼Œç™½è‰²è¡¨ç¤º 0ã€‚æ‰€ä»¥é€šè¿‡ä¸ªäººå¾®ä¿¡äºŒç»´ç çš„ç‰ˆæœ¬æ˜¯å¤šå°‘å‘¢ï¼ŸğŸ™ƒ

![qr-smallest-unit](https://upload-images.jianshu.io/upload_images/7154520-add155b96bb60412.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/599/format/webp)

äºŒç»´ç å›¾æ¡ˆåˆ†ä¸ºå¾ˆå¤šå­éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š

![qr-code-functionl-split](https://user-images.githubusercontent.com/13174560/48657450-e3db4b00-ea6b-11e8-925b-e279de3025a2.png)

- åŠŸèƒ½åŒºåŸŸï¼Œä¸åŒ…å«å®è´¨æ€§çš„ä¿¡æ¯ï¼Œåªæ˜¯ä¸€äº›è¾…åŠ©ä½œç”¨
  - ä½ç½®æ¢æµ‹åŒºåŸŸï¼šä¸€å…±æœ‰ 3 ä¸ªï¼Œç”¨äºå†³å®šäºŒç»´ç çš„å“ªä¸€è¾¹åº”è¯¥æœä¸Š,è¿™æ ·æˆ‘ä»¬ä¸ç®¡ä»ä»€ä¹ˆæ–¹å‘æ‰«ç éƒ½ä¸ä¼šæ··ä¹±äº†ã€‚å®ƒæ˜¯ä¸€ä¸ªå›ºå®šå¤§å°çš„å›å­—
    ![position-detection](https://upload-images.jianshu.io/upload_images/7154520-38a3b2ecf9b8189a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/148/format/webp)
  - ä½ç½®æ¢æµ‹å›¾å½¢åˆ†éš”ç¬¦ï¼šå°†ä½ç½®æ¢æµ‹åŒºåŸŸå›´èµ·æ¥çš„å›ºå®šå®½åº¦ 1 çš„ç™½è‰²â€œå›´æ â€
  - å®šä½å›¾å½¢ï¼š ä¹Ÿå«`Timing Patterns`ï¼Œæ˜¯ä¸¤æ ¹é»‘ç™½ç›¸é—´çš„é•¿æ¡ï¼Œæ¯ä¸€æ ¹çš„å¤´å°¾éƒ½æ˜¯é»‘è‰²ã€‚ä¸»è¦ç”¨æ¥ååŠ©æœºå™¨æ‰«æçš„
  - æ ¡æ­£å›¾å½¢ï¼š æ˜¯æ¯”è¾ƒå°çš„å›å­—ï¼Œç”¨äºæ ¡æ­£
    ![alignment-patterns](http://officialblog-wordpress.stor.sinaapp.com/uploads/2013/10/31.jpg)
    ä¸åŒçš„`version`æ‹¥æœ‰ä¸åŒæ•°é‡çš„æ ¡æ­£å›¾å½¢ï¼Œä¾‹å¦‚
    ![alignment-patterns-count](http://officialblog-wordpress.stor.sinaapp.com/uploads/2013/10/6.png)
    ä¸¾ä¾‹`version 8`çš„`(6,24,42)`æ˜¯å¦‚ä½•ç”»æ ¡æ­£å›¾å½¢çš„ï¼š
    ![alignment-patterns-example](http://officialblog-wordpress.stor.sinaapp.com/uploads/2013/10/7.png)
- ç¼–ç åŒºï¼Œå®é™…å­˜å‚¨æœ‰æ„ä¹‰æ•°æ®çš„åŒºåŸŸï¼ŒåŒ…å« 3 ä¸ªå­éƒ¨åˆ†

  - æ ¼å¼ä¿¡æ¯ï¼šæ‰€æœ‰`version`çš„äºŒç»´ç éƒ½æœ‰ï¼Œå­˜æ”¾äºŒç»´ç çš„å®¹é”™çº§åˆ«+æ•°æ®æ©ç +äºŒè€…çš„çº é”™ç 
  - ç‰ˆæœ¬ä¿¡æ¯ï¼šè¡¨ç¤ºäºŒç»´ç çš„`version`ï¼Œ[`version >=7`æ‰ä¼šç»˜åˆ¶è¿™ä¸ªåŒºåŸŸ](https://www.thonky.com/qr-code-tutorial/format-version-information)ã€‚ï¼ˆå…¶å®è‚‰çœ¼æ•°æ ¼å­ä¹Ÿå¯ä»¥çŸ¥é“ç‰ˆæœ¬ä¿¡æ¯ ğŸ˜† ï¼‰
  - æ•°æ®å’Œçº é”™ç ï¼šå­˜å‚¨çœŸæ­£çš„æ•°æ®ï¼ŒåŒæ—¶ç”±äºçº é”™ç çš„å­˜åœ¨ï¼Œä½¿å¾—å³ä½¿äºŒç»´ç æ±¡æŸäº†ä¸€éƒ¨åˆ†ä¹Ÿå¯ä»¥è¯»å–. æ•´ä¸ªç°è‰²åŒºåŸŸéƒ½ç”¨æ¥å­˜æ”¾æ­¤éƒ¨åˆ†æ•°æ®ã€‚äºŒç»´ç æ”¯æŒ 4 ç§çº§åˆ«çš„çº é”™ï¼š

    | Error Correction Level | Error Correction Capability |
    | ---------------------- | --------------------------- |
    | L                      | Recovers 7% of data         |
    | M                      | Recovers 15% of data        |
    | Q                      | Recovers 25% of data        |
    | H                      | Recovers 30% of data        |

    çº é”™çº§åˆ«è¶Šé«˜ï¼Œæ¢å¤èƒ½åŠ›è¶Šå¼ºï¼Œä»£ä»·æ˜¯èƒ½å­˜å‚¨çš„æœ‰æ•ˆæ•°æ®è¶Šå°‘ï¼Œå› ä¸ºçº é”™ç çš„å æ¯”ä¼šè¶Šé«˜ã€‚

æ¥ä¸‹æ¥ä¸»è¦ä»‹ç»æ ¸å¿ƒçš„æ•°æ®å’Œçº é”™ç éƒ¨åˆ†ã€‚

# ç¼–ç æ­¥éª¤

æ­¥éª¤æ˜¯å…ˆå¯¹æºæ•°æ®è¿›è¡Œç¼–ç ï¼Œç„¶åä¾æ®ç¼–ç ç»“æœè®¡ç®—å¾—åˆ°çº é”™ç ï¼Œæœ€åå†åœ¨ç»“å°¾åŠ ä¸Šä¸€äº›ç”¨äºè¡¥é½çš„å­—èŠ‚å°± ok äº†ã€‚

## æºæ•°æ®ç¼–ç 

### ç¼–ç æ¨¡å¼ï¼ˆæ¨¡å¼æŒ‡ç¤ºç¬¦ï¼‰

ç±»ä¼¼äº`utf8`ç¼–ç ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå°±æ˜¯ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå°†å…¶ç¼–ç æˆä¸€ä¸²äºŒè¿›åˆ¶æ•°ã€‚æ”¯æŒçš„ç¼–ç æ¨¡å¼æœ‰ï¼š

1. [æ•°å­—ç¼–ç (`Numeric Mode`)](https://zhuanlan.zhihu.com/p/25432628): åªæ”¯æŒæ•°å­— 0~9 çš„ç¼–ç 
2. [å­—ç¬¦ç¼–ç (`Alphanumeric Mode`)](https://zhuanlan.zhihu.com/p/25432642)ï¼šæ”¯æŒåŒ…å«æ•°å­—ã€**å¤§å†™**çš„`A-Z`(ä¸åŒ…å«å°å†™)ã€ä»¥åŠ`$ % * + â€“ . / :`å’Œç©ºæ ¼
   ![alphanumeric-mode](http://officialblog-wordpress.stor.sinaapp.com/uploads/2013/10/21.png)
3. [å­—èŠ‚ç¼–ç (`Byte Mode`)](https://zhuanlan.zhihu.com/p/25432647): æ”¯æŒ`0x00`~`0xFF`å†…æ‰€æœ‰çš„å­—ç¬¦
4. [æ—¥æ–‡ç¼–ç (`Kanji Mode`)](https://zhuanlan.zhihu.com/p/25432667)ï¼š åªèƒ½æ”¯æŒ`0x8140`~`0x9FFC`ã€`0xE040`~`0xEBBF`çš„å­—ç¬¦ï¼Œå¯ä»¥[åœ¨è¿™é‡Œæ‰¾åˆ°](http://www.rikai.com/library/kanjitables/kanji_codes.sjis.shtml)
5. `ECI mode`: ä¸»è¦ç”¨äºç‰¹æ®Šçš„å­—ç¬¦é›†ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„æ‰«æå™¨éƒ½æ”¯æŒè¿™ç§ç¼–ç 
6. `Structured Append mode`: ç”¨äºæ··åˆç¼–ç ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªäºŒç»´ç ä¸­åŒ…å«äº†å¤šç§ç¼–ç æ ¼å¼
7. `FNC1 mode`: è¿™ç§ç¼–ç æ–¹å¼ä¸»è¦æ˜¯ç»™ä¸€äº›ç‰¹æ®Šçš„å·¥ä¸šæˆ–è¡Œä¸šç”¨çš„ã€‚æ¯”å¦‚ GS1 æ¡å½¢ç ä¹‹ç±»çš„ã€‚

æ¯ç§æ¨¡å¼éƒ½ç”± 4 ä½äºŒè¿›åˆ¶çš„æ¨¡å¼æŒ‡ç¤ºç¬¦ç¡®å®šï¼š

| Mode Name         | Mode Indicator |
| ----------------- | -------------- |
| Numeric Mode      | `0001`         |
| Alphanumeric Mode | `0010`         |
| Byte Mode         | `0100`         |
| Kanji Mode        | `1000`         |
| ECI Mode          | `0111`         |

ä¾‹å¦‚å­—ç¬¦ä¸²`123`ï¼Œå°±å¯ä»¥ä½¿ç”¨`Numeric Mode`ï¼›è€Œ`HELLO WORLD`éœ€è¦ç”¨`Alphanumeric Mode`ï¼›`Hello world`éœ€è¦ä½¿ç”¨`Byte Mode`.

### ç‰ˆæœ¬ã€çº é”™çº§åˆ«ç¡®å®š

é¦–å…ˆä¾æ®æºå­—ç¬¦ä¸²å¯ä»¥çŸ¥é“åº”è¯¥é‡‡ç”¨å“ªç§ç¼–ç æ–¹å¼ï¼Œç„¶åéœ€è¦å…ˆç¡®å®šçº é”™çº§åˆ«ï¼Œ[æœ€åä¸åŒç‰ˆæœ¬åœ¨æ­¤çº é”™çº§åˆ«+ç¼–ç æ–¹å¼ä¸‹çš„æ•°æ®å®¹é‡æ˜¯ä¸åŒçš„](https://www.thonky.com/qr-code-tutorial/character-capacities)ã€‚æˆ‘ä»¬åªéœ€æ‰¾åˆ°æœ€å°çš„èƒ½å®¹çº³æ‰€æœ‰æ•°æ®çš„é‚£ä¸ªç‰ˆæœ¬å³å¯ã€‚

ä¸¾ä¾‹æ¥è¯´ï¼šå­—ç¬¦ä¸² `HELLO WORLD`åŒ…å« 11 ä¸ªå­—ç¬¦ï¼Œé€šè¿‡ä¸Šé¢çš„ä»‹ç»å¾—çŸ¥ï¼Œå®ƒåº”è¯¥ä½¿ç”¨å­—ç¬¦ç¼–ç `Alphanumeric Mode`ï¼Œå¦‚æœè®¾å®šçº é”™çº§åˆ«æ˜¯`Q`,é€šè¿‡æŸ¥è¡¨å¾—çŸ¥`1-Q`å¯ä»¥å®¹çº³ 16 ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆæœ€ä½å°±å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬ 1ï¼š

![character-capacities-table](character-capacities-table.png)

å¦‚æœæ˜¯å­—ç¬¦ä¸²`HELLO THERE WORLD`(17 ä¸ªå­—ç¬¦)ï¼Œé‚£ä¹ˆæœ€ä½ç‰ˆæœ¬å°±åªèƒ½é€‰ 2 äº†ã€‚

å¦å¤–ï¼Œå¯ä»¥æ¨æ–­ï¼Œ**äºŒç»´ç æ˜¯å­˜åœ¨æ•°æ®å®¹é‡ä¸Šé™çš„**ï¼Œå®ƒåº”è¯¥æ˜¯`40-L`çš„å®¹é‡ï¼š

| Encoding Mode | Maximum number of characters a 40-L code can contain in that mode |
| ------------- | ----------------------------------------------------------------- |
| Numeric       | 7089 characters                                                   |
| Alphanumeric  | 4296 characters                                                   |
| Byte          | 2953 characters                                                   |
| Kanji         | 1817 characters                                                   |

ä¹Ÿå°±æ˜¯è¯´ï¼Œå•çº¯å­˜å‚¨æ•°å­—çš„è¯ï¼Œå¯ä»¥å­˜ 7089 ä¸ªï¼›åªå­˜å¤§å†™å­—æ¯çš„è¯ï¼Œå¯ä»¥å­˜å¤§çº¦ 4k ä¸ªã€‚

### å­—ç¬¦è®¡æ•°æŒ‡ç¤ºç¬¦

æ˜¯ä¸€ä¸²äºŒè¿›åˆ¶æ•°å­—ï¼Œè¡¨ç¤ºæºå­—ç¬¦ä¸²çš„å­—ç¬¦ä¸ªæ•°ã€‚å­—ç¬¦è®¡æ•°æŒ‡ç¤ºç¬¦å¿…é¡»**æ”¾åœ¨æ¨¡å¼æŒ‡ç¤ºç¬¦ä¹‹å**ã€‚æ­¤å¤–ï¼Œå­—ç¬¦è®¡æ•°æŒ‡ç¤ºç¬¦æœ‰ç‰¹å®šçš„ä½é•¿ï¼Œå…·ä½“å–å†³äºäºŒç»´ç çš„ç‰ˆæœ¬å’Œç¼–ç æ¨¡å¼ï¼š

| å•ä½ bits         | Versions 1 ~ 9 | Versions 10 ~ 26 | Versions 27 ~ 40 |
| ----------------- | -------------- | ---------------- | ---------------- |
| Numeric mode      | 10             | 12               | 14               |
| Alphanumeric mode | 9              | 11               | 13               |
| Byte mode         | 8              | 16               | 16               |
| Kanji mode        | 8              | 10               | 12               |

å…·ä½“æ­¥éª¤æ˜¯ï¼šè®¡ç®—åŸå§‹è¾“å…¥æ–‡æœ¬çš„å­—ç¬¦æ•°ï¼Œå°†å…¶è½¬ä¸ºäºŒè¿›åˆ¶æ•°å­—ã€‚æ ¹æ®ç‰ˆæœ¬å’Œç¼–ç æ¨¡å¼æ‰¾åˆ°å¯¹åº”çš„ä½é•¿ï¼Œä¸å¤Ÿä½é•¿çš„åœ¨å‰é¢åŠ  0 è¡¥é½ã€‚

ä¾‹å¦‚ `HELLO WORLD`, ç‰ˆæœ¬å·ä¸º 1ï¼Œåˆ™å­—ç¬¦è®¡æ•°æŒ‡ç¤ºç¬¦éœ€è¦ 9 bits.
`HELLO WORLD`çš„å­—ç¬¦æ•°ä¸º 11ï¼Œè½¬ä¸ºäºŒè¿›åˆ¶`1011`ï¼Œä¸å¤Ÿ 9 ä½ï¼Œéœ€è¦è¡¥ä¸Š 5 ä¸ª 0ï¼Œæœ€ç»ˆç»“æœæ˜¯`000001011`

é‚£ä¹ˆé’ˆå¯¹`HELLO WORLD`ï¼Œæˆ‘ä»¬ç›®å‰è·å¾—çš„äºŒè¿›åˆ¶ä¸²æ˜¯`0010 000001011`ï¼Œ`0010`æ˜¯æ¨¡å¼æŒ‡ç¤ºç¬¦`Alphanumeric Mode`ã€‚

### å­—ç¬¦ä¸²ç¼–ç 

è¿™ä¸€æ­¥å°±æ˜¯åˆ©ç”¨ç¼–ç æ¨¡å¼å¯¹æºå­—ç¬¦ä¸²è¿›è¡Œç¼–ç ï¼Œæˆ‘ä»¬ä»ä»¥`HELLO WORLD`ä¸ºä¾‹ï¼Œä½¿ç”¨[`Alphanumeric Mode`](https://zhuanlan.zhihu.com/p/25432642)ã€‚

1. å°†å­—ç¬¦ä»¥ 2 ä¸ºé—´éš”åˆ†ç»„ï¼Œå¾—åˆ°`(H,E)`ã€ `(L,L)`ã€`(O, )`ã€`(W,O)`ã€`(R,L)`ã€`(D)`
2. åœ¨[å­—æ¯ç´¢å¼•è¡¨](http://officialblog-wordpress.stor.sinaapp.com/uploads/2013/10/21.png)ä¸­æ‰¾åˆ°å¯¹åº”çš„`value`ï¼Œå¾—åˆ°`(17,14)`ã€ `(21,21)`ã€`(24,36)`ã€`(32,24)`ã€`(27,21)`ã€`(13)`
3. å¯¹äºæ¯ç»„æ•°å­—ï¼Œå°†ç¬¬ä¸€ä¸ªæ•°å­—ä¹˜ä»¥ 45 åŠ ä¸Šç¬¬äºŒä¸ªæ•°å­—ï¼ˆæœ€å¤§ç»“æœ 2024ï¼‰ï¼Œå¾—åˆ°çš„ç»“æœå†è½¬ä¸ºé•¿åº¦ä¸º 11 çš„äºŒè¿›åˆ¶ä¸²ï¼Œé•¿åº¦ä¸è¶³çš„å‰é¢è¡¥ 0ã€‚ä¾‹å¦‚`(17,14) => 17*45+14=779 => 1100001011 => 01100001011`ã€‚å¦‚æœæœ€åä¸€ç»„æ˜¯å•ä¸ªå­—ç¬¦ï¼Œåˆ™ç”¨ 6 ä½è¡¨ç¤ºå°±è¡Œã€‚æœ€ç»ˆå¾—åˆ°ç»“æœï¼š

   ```js
   01100001011 01111000110 10001011100 10110111000 10011010100 001101
   ```

è¿½åŠ åˆ°æ¨¡å¼æŒ‡ç¤ºç¬¦å’Œå­—ç¬¦è®¡æ•°æŒ‡ç¤ºç¬¦ä¹‹åï¼Œå¾—åˆ°ç»“æœï¼š

```js
0010 000001011 01100001011 01111000110 10001011100 10110111000 10011010100 001101
```

### ç»“æŸç¬¦ 0000

### æœ«å°¾è¡¥ 0 ç›´åˆ° 8 çš„å€æ•°

### æ ¹æ®ç‰ˆæœ¬+çº é”™çº§åˆ« -> æ•°æ®åŒºé•¿åº¦

### å¡«å…… magic è¡¥é½ç åˆ°æ•°æ®åŒºé•¿åº¦

## çº é”™ç ç”Ÿæˆ

ä¸»è¦å‚è€ƒï¼šhttps://www.freebuf.com/geek/204516.html

## æœ€ç»ˆçš„æ•°æ®

æ•°æ®åŒºç¼–ç +çº é”™ç +N ä¸ªå­—èŠ‚çš„å‰©ä½™ä½ï¼ˆå…¨ 0ï¼Œå…·ä½“ä¸ªæ•°ç”±ç‰ˆæœ¬å†³å®šï¼š https://www.thonky.com/qr-code-tutorial/structure-final-message

## ç»˜åˆ¶äºŒç»´ç 

### 3 ä¸ªä½ç½®æ¢æµ‹æ–¹å—

### N ä¸ªæ ¡æ­£æ–¹å—

### 2 ä¸ªå®šä½æ¡

### æ ¼å¼ä¿¡æ¯

### ç‰ˆæœ¬ä¿¡æ¯

### æ•°æ®åŒº+çº é”™ç åŒº

### æ©ç å›¾æ¡ˆï¼šä¸ºäº†é¿å…å¤§ç‰‡ç©ºç™½æˆ–é»‘å—é€ æˆè¯†åˆ«å›°éš¾

# è§£ç è¿‡ç¨‹

å‚è€ƒhttps://www.freebuf.com/geek/204516.html

# å‚è€ƒèµ„æ–™

- http://blog.sae.sina.com.cn/archives/1139
- https://bytekm.bytedance.net/kmf/articleDetail/2546
- https://www.jianshu.com/p/38c4781c1f5d
- https://www.freebuf.com/geek/204516.html
- https://zhuanlan.zhihu.com/p/25423714
- è‹±æ–‡ tutorialï¼šhttps://www.thonky.com/qr-code-tutorial/
